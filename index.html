<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>CSS: The Hard Parts - </title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="stylesheets/screen.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<header>
	<h1 class="tagline">CSS: The Hard Parts</h1>
    <h1 class='sub-tagline'>Sub-Tagline TBD</h1>
</header>
<nav id="TOC">
<ul>
<li><a href="#why-this-book">Why This Book?</a></li>
<li><a href="#tools-well-be-using">Tools We’ll Be Using</a><ul>
<li><a href="#pedantic-examples">Pedantic Examples</a></li>
<li><a href="#styleguide-driven-development-or-sdd">Styleguide Driven Development (or SDD)</a></li>
<li><a href="#reference-materials">Reference Materials</a></li>
<li><a href="#whats-a-styleguide">What’s a Styleguide?</a></li>
<li><a href="#styleguide-driven-development">Styleguide Driven Development</a></li>
<li><a href="#setting-up-tdcss">Setting Up TDCSS</a></li>
<li><a href="#our-first-module">Our First Module</a></li>
</ul></li>
<li><a href="#cascade-rules">Cascade Rules</a><ul>
<li><a href="#css-rule-sorting">CSS Rule Sorting</a></li>
<li><a href="#origin">Origin</a></li>
<li><a href="#weight-beats-specificity">Weight Beats Specificity</a></li>
<li><a href="#styles-that-stick">Styles That Stick</a><ul>
<li><a href="#inheritance">Inheritance</a></li>
<li><a href="#initial-value">Initial Value</a></li>
</ul></li>
<li><a href="#rule-evaluation">Rule Evaluation</a></li>
<li><a href="#take-a-deep-breath">Take a Deep Breath</a></li>
<li><a href="#specificity">Specificity</a><ul>
<li><a href="#calculating-specificity">Calculating Specificity</a></li>
<li><a href="#specificity-and-inheritance">Specificity and Inheritance</a></li>
<li><a href="#specificity-and-performance">Specificity and Performance</a></li>
</ul></li>
<li><a href="#media">Media</a><ul>
<li><a href="#print-media">Print Media</a></li>
<li><a href="#debugging-print-styles">Debugging Print Styles</a></li>
</ul></li>
<li><a href="#resources">Resources</a></li>
</ul></li>
<li><a href="#visual-formatting">Visual Formatting</a><ul>
<li><a href="#box-model-review">Box Model Review</a><ul>
<li><a href="#edges">Edges</a></li>
<li><a href="#backgrounds">Backgrounds</a></li>
<li><a href="#widths">Widths</a></li>
</ul></li>
<li><a href="#margins">Margins</a></li>
<li><a href="#horizontal-formatting">Horizontal Formatting</a><ul>
<li><a href="#width">Width</a></li>
<li><a href="#overconstrained-values">Overconstrained Values</a></li>
<li><a href="#horizontal-centering">Horizontal Centering</a></li>
</ul></li>
<li><a href="#vertical-formatting">Vertical Formatting</a><ul>
<li><a href="#margin-collapsing">Margin Collapsing</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<section id="why-this-book" class="level1">
<h1>Why This Book?</h1>
<p>I’ve observed that there are certain areas of CSS that seem to fluster and confuse many developers in our industry. This is an issue because small, medium, and large teams alike, will tend to: * Add technical debt as they write poor CSS code * Miss deadlines because they spend too much time “fighting the DOM” * Stop having fun!</p>
<p>With this in mind, I’ve decided to focus on primarily on–what I’m calling CSS’s <em>hard parts</em>–with the hopes that you’ll be armed with the foundation that will help you to breeze through the next feature you have to code up. Now <em>hard parts</em> is a bit of a misnomer because there are plenty of hard parts we will <em>not</em> be addressing. What I will be focusing on, primarily, are parts of CSS that allow you to: * Create useful components (or modules if you prefer) * Layout pages and sections of pages</p>
<p>These two core tasks are the day-to-day, in the trenches reality of what a front-end developer or designer must tackle to keep pace with that next feature’s technical demands. So what does this mean?</p>
<ul>
<li>We’ll focus more on core visual formatting and box-model related concepts and quirks than things like <em>selectors</em>, fancy CSS3 features. For some reason it seems that developers have much less trouble with the later than the former.</li>
</ul>
</section>
<section id="tools-well-be-using" class="level1">
<h1>Tools We’ll Be Using</h1>
<p>CSS is very hard to understand without lots of live examples and visual aids. We’ll use a combination of the following tools as listed:</p>
<section id="pedantic-examples" class="level3">
<h3>Pedantic Examples</h3>
<p>We’ll use the online tool, <a href="codepen.io" class="uri">codepen.io</a> for examples that are mainly pedantic in nature, but help to illustrate a concept or a set of concepts.</p>
</section>
<section id="styleguide-driven-development-or-sdd" class="level3">
<h3>Styleguide Driven Development (or SDD)</h3>
<p>We’ll also build a small component library as we study the “hard parts” of CSS since: * There’s nothing like real world examples to bring home CSS’s core concepts * It’s always fun to have something useful as an extra benefit of study :)</p>
</section>
<section id="reference-materials" class="level3">
<h3>Reference Materials</h3>
<p>Admittedly, much of the material we’ll cover is available directly from the <a href="http://www.w3.org/TR/CSS2/">specification</a> and, essentially, derivative of that single source of truth. However, my hope is that this content will provide a more accessible coverage of this information and also show how it’s applied in a practical way. All said, we will be heavily referencing the following excellent materials (all of which you should strongly consider adding to your collection of “must-read” materials if you’re really serious about your CSS chops!):</p>
<ul>
<li><p><a href="http://www.w3.org/TR/CSS2/">CSS 2.1 Specification</a> The spec is sometimes hard to understand on the first read, but it’s always reliable and definitive.</p></li>
<li><p>Eric Meyer’s <a href="http://meyerweb.com/eric/books/css-tdg/">CSS: The Definitive Guide, Third Edition</a> I think of this text as a sort of annotated and slightly more readable version of the spec (hey, he wrote test specs for CSS itself so he’s gotta know the spec…right?!?!). Having them both available is great for cross-reference.</p></li>
<li><p>Russ Weakley’s <a href="http://www.slideshare.net/maxdesign/presentations">Slideshare Presentations</a> I’ll be linking to some of my favorites of these Slideshares as they are extremely approachable and visual, while–at the same time–accurate and trustworthy.</p></li>
<li><p><a href="http://www.cssmastery.com/">CSS Mastery</a></p></li>
</ul>
<p>Another very useful book that many “CSS wizards” swear by.</p>
</section>
<section id="whats-a-styleguide" class="level2">
<h2>What’s a Styleguide?</h2>
</section>
<section id="styleguide-driven-development" class="level2">
<h2>Styleguide Driven Development</h2>
<ul>
<li>Examples of great styleguides e.g. Mailchimp, Starbucks</li>
<li>Styleguide Generators,Pattern Library</li>
<li>Why TDCSS? (live styleguide, etc.)</li>
</ul>
</section>
<section id="setting-up-tdcss" class="level2">
<h2>Setting Up TDCSS</h2>
<ul>
<li>Testing your module</li>
<li>A bit of styling (SHOW HOW TO STYLE TDCSS)</li>
<li>Getting your team to use your module (and other benefits of having a styleguide)</li>
</ul>
</section>
<section id="our-first-module" class="level2">
<h2>Our First Module</h2>
<p>TBD .. media box???</p>
</section>
</section>
<section id="cascade-rules" class="level1">
<h1>Cascade Rules</h1>
<p>This chapter will discuss how the browser determines which style rule(s) to apply to a particular DOM element. The details for how this is done are in the <a href="http://www.w3.org/TR/CSS2/cascade.html">specification</a> on the Cascade.</p>
<section id="css-rule-sorting" class="level2">
<h2>CSS Rule Sorting</h2>
<p>Before we dive in to the details, let’s attempt to get a broad overview of the four-step process browsers use to determine which rules to apply for a given element:</p>
<ol type="1">
<li><strong>Gather Qualified Declarations:</strong> First gather all declarations that apply to the element for the current medium (example mediums might be: <em>screen</em>, <em>print</em>, <em>tv</em>, <em>braille</em>, etc. See <a href="http://www.w3.org/TR/CSS21/media.html#media-types">the media types spec</a> for all available media types). Pass all matches through to the next part of the sorting algorthm</li>
<li><strong>Sort by Origin:</strong> Next, we sort by stylesheet <em>origin</em> in ascending order of precedence provided by <a href="http://www.w3.org/TR/CSS2/cascade.html#cascading-order">the spec</a> as follows:</li>
</ol>
<ul>
<li>user agent declarations</li>
<li>user normal declarations</li>
<li>author normal declarations</li>
<li>author important declarations</li>
<li>user important declarations (intuitively we can see that, in order to provide proper accessibility, user’s with special requirements need a means of having “the final say” for things like increased text size)</li>
</ul>
<p><em>The term <strong>weight</strong> is used to describe the priority assigned to competing style rules using the above considerations. Style rules with a higher <strong>weight</strong> will take precedence over those with a lower <strong>weight</strong>.</em></p>
<ol start="3" type="1">
<li><strong>Sort by Specificity:</strong> If (and only if) the above sort results in rules that have the same importance and origin, than sort those rules by selector specificity</li>
<li><strong>Sort by Order of Declaration:</strong> If (and only if) the competing declarations have the same weight and specificity, than sort by order specified (where the latter specified rule wins).</li>
</ol>
<p>The reason we’re describing the sort ordering process first, is that it’s important to understand the sequence in which weight, specificity, and declaration order are evaluated. First <em>weight</em>, then <em>specificity</em>, and finally <em>order of declaration</em>.</p>
<p><em>There’s actually another dimension to this. If we have elements that don’t have any styles applied directly to them, there’s still the case that those elements may “inherit” styles from their ancestors. Further, style properties have initial default values to consider. We’ll cover those details in a bit.</em></p>
<p>Now that we’ve discussed the browser’s overall strategy for sorting style rules, let’s look at <strong>origin</strong>, <strong>specificity</strong>, and <strong>inheritance</strong> in more detail.</p>
</section>
<section id="origin" class="level2">
<h2>Origin</h2>
<p>There are three <strong>types</strong> of stylesheets that a browser must consider when sorting in ascending orders of precendence:</p>
<ol type="1">
<li>User Agent stylesheet</li>
</ol>
<p>The user agent stylesheet sets up a browser’s default styles. Note that each browser has its own stylesheet so Chrome’s default style will be a bit different than say Firefox’s.</p>
<ol start="2" type="1">
<li>User stylesheet</li>
</ol>
<p>User’s can define their own stylesheets to override the browser’s default stylesheet. As such, the user stylesheet is given more <strong>weight</strong> than the browser’s stylesheet.</p>
<ol start="3" type="1">
<li>Author stylesheet</li>
</ol>
<p>Page authors get the highest precedence and their stylesheets will override both the user agent and user stylesheets (with the earlier caveat that any rule with <code>!important</code> from the user stylesheet will override all other rules providing for accessibility concerns).</p>
<p>The type of stylesheet that is being considered–user agent, user, or author–determines the stylesheet <strong>origin</strong>.</p>
</section>
<section id="weight-beats-specificity" class="level2">
<h2>Weight Beats Specificity</h2>
<p>As noted from the sorting process described earlier, the browser will prioritize rules with more weight before considering specificity. This is rarely an issue to page authors since an author stylesheet generally gets the most weight anyway (ignoring, of course, the user stylesheet <code>!important</code> special case). However, it’s worth noting that it’s possible for specificity to be completely ignored when origin and/or importance are not the same. Consider a page that includes a simple author stylesheet like so:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span>
<span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">&quot;en&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;head&gt;</span>
<span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">utf-8</span><span class="kw">&gt;</span>
<span class="kw">&lt;title&gt;</span>Cascade Example<span class="kw">&lt;/title&gt;</span>
<span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> href=</span><span class="st">&quot;author.css&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/head&gt;</span>
<span class="kw">&lt;body&gt;</span>
  <span class="kw">&lt;h1</span><span class="ot"> id=</span><span class="st">&quot;obnoxious&quot;</span><span class="kw">&gt;</span>I&#39;m an h1<span class="kw">&lt;/h1&gt;</span>
<span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<pre class="sourceCode css"><code class="sourceCode css"><span class="co">/* AUTHOR STYLESHEET */</span>
h1 <span class="kw">{</span>
  <span class="kw">font-size:</span> <span class="dt">72px</span><span class="kw">;</span>
  <span class="kw">font-family:</span> <span class="st">&quot;Arial Rounded MT Bold&quot;</span>, <span class="st">&quot;Arial Narrow Bold&quot;</span>, <span class="dt">sans-serif</span><span class="kw">;</span>
  <span class="kw">font-weight:</span> <span class="dt">normal</span><span class="kw">;</span>
  <span class="kw">text-transform:</span> <span class="dt">uppercase</span><span class="kw">;</span>
  <span class="kw">color:</span> <span class="dt">purple</span><span class="kw">;</span>
<span class="kw">}</span></code></pre>
<p>Now consider a user stylesheet that is added as a preference:</p>
<pre class="sourceCode css"><code class="sourceCode css"><span class="co">/* USER STYLESHEET */</span>
<span class="fl">#obnoxious</span> <span class="kw">{</span>
  <span class="kw">color:</span> <span class="dt">green</span><span class="kw">;</span>
  <span class="kw">font-style:</span> <span class="dt">italic</span><span class="kw">;</span>
  <span class="kw">font-size:</span> <span class="dt">24px</span><span class="kw">;</span>
<span class="kw">}</span></code></pre>
<p>We haven’t yet discussed the rules for specificity, but an ID selector (like <code>#obnoxious</code>), is much more specific than an element selector (like the <code>h1</code> defined in the author stylesheet above). Intuitively, you may think that the <code>#obnoxious</code> rule would “win the battle” since it’s more specific. However, in fact, the less specific <code>h1</code> rule from the author stylesheet will get used since the sorting process prefers origin over specificity. Let’s take a look at this example a bit more visually.</p>
<p>First we add our custom user stylesheet via Safari’s preferences:</p>
<p><img src="examples/cascade/safari-preference-user-style.png" title="Adding a user stylesheet via Safari&#39;s preferences dialog" alt="Safari preferences" /><br /> When we open our test page in Safari we clearly see that the author style rules override any conflicting user style rules:</p>
<p><img src="examples/cascade/cascade-user-styles.png" title="Notice that the author style rule wins even though the user&#39;s stylesheet rule is more specific" alt="User and author stylesheet’s in Safari" /><br /> We glean the following from this example:</p>
<ul>
<li>The <code>font-style</code> is not defined in the author stylesheet so the italic defined by the user gets used</li>
<li><code>color</code> is defined in both but the author’s <code>purple</code> gets used given the origin principle</li>
<li>same for <code>font-size</code>–the author’s <code>72px</code> value is used</li>
<li><code>font-weight</code> is used in two stylesheets–the user agent defines it as <code>bold</code> while the author defines it as <code>normal</code>. It’s a bit hard to see that the weight is <em>normal</em> since it’s a heavy font (you’ll have to trust me). Nevertheless, the author’s rule wins that battle as well</li>
</ul>
<p>This example clearly illustrates that, although it’s rarely an issue to page authors since their stylesheet is the most weighty, origin is considered over specificity.</p>
</section>
<section id="styles-that-stick" class="level2">
<h2>Styles That Stick</h2>
<p>There are a few ways that styles rules will get applied. The most obvious is an explicit rule gets defined such directly such as:</p>
<pre class="sourceCode css"><code class="sourceCode css">h1<span class="fl">.gaudy</span> <span class="kw">{</span>
  <span class="kw">color:</span> hotpink<span class="kw">;</span>
<span class="kw">}</span></code></pre>
<p>With this definition, we are directly applying the color <code>hotpink</code> to any level one header with the class <code>gaudy</code>. This is a cascading style–simple enough. There are a couple of more subtle ways that a style rule may get applied such as <strong>inheritance</strong> and <strong>initial</strong> value. Let’s look at those next.</p>
<section id="inheritance" class="level3">
<h3>Inheritance</h3>
<p>According to the <a href="http://www.w3.org/TR/CSS2/cascade.html#inheritance">spec</a>:</p>
<blockquote>
<p>When inheritance occurs, elements inherit computed values. The computed value from the parent element becomes both the specified value and the computed value on the child.</p>
</blockquote>
<p>Inheritance happens when descendent elements take on the styles defined by an ancestor element. In the following example, the paragraph element will inherit the font family defined in its parent element <code>.outer</code> since <code>font-family</code> <a href="http://www.w3.org/TR/css3-fonts/#font-family-prop">is an inherited property</a>:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;style&gt;</span>
  <span class="fl">.outer</span> <span class="kw">{</span>
    <span class="kw">font-family:</span> <span class="dt">sans-serif</span><span class="kw">;</span>
  <span class="kw">}</span>
<span class="kw">&lt;/style&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;outer&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p&gt;</span>I will be a san-serif<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>Note that some types of CSS properties are inherited, others are not. <a href="http://www.w3.org/TR/CSS2/propidx.html">See this table</a>, but, for example, <code>color</code> is an inherited property, while <code>display</code> and <code>border</code> are <a href="http://dev.w3.org/csswg/css-backgrounds/#borders">not</a>. These rules tend to make intuitive sense–if <code>borders</code> were inherited, it would be a big issue; you’d end up with a maze of borders for elements that have children!</p>
<p>In terms of precedence, inheritance comes after cascading values, but before initial values.</p>
</section>
<section id="initial-value" class="level3">
<h3>Initial Value</h3>
<p><a href="http://reference.sitepoint.com/css/defaultvalues">Sitepoint</a> provides an overview of how initial values work:</p>
<blockquote>
<p>The default value for a property, when it’s not specified explicitly or inherited, is called the initial value. The initial value of each property is defined in the CSS specification.</p>
</blockquote>
<blockquote>
<p>Browsers have user agent style sheets that define the default rendering of the various HTML element types. In some cases, the rules in those built-in style sheets define values other than the initial values from the CSS specification. For example, links are usually underlined, even though the initial value for the text-decoration property is none.</p>
</blockquote>
<p>Another example of initial value is <code>border-color</code>, which will get a default of the <a href="http://www.w3.org/TR/css3-color/#currentcolor">currentColor</a> (essentially, the current value of the <code>color</code> property). Initial value comes after cascading and inherited values in terms of precedence.</p>
<p>The browser has to work out the details of how cascaded, inherited, and initial style values are applied to any given element. Let’s examine how that process works next.</p>
</section>
</section>
<section id="rule-evaluation" class="level2">
<h2>Rule Evaluation</h2>
<p>Once the browser has constructed a document tree–a tree-based hierarchy of elements representing the source document–it needs to take any <strong>specified values</strong> and resolve them to <strong>computed values</strong> (for example, <code>em</code> units are converted to pixels and URIs are made absolute), and then finally resolve those computed values to <strong>used values</strong> and then <strong>actual values</strong>. A used value might be the result of evaluating a rule like: <code>width: 75%</code>. Obviously, determining what that percentage width is calculating from has to happen at run-time. The actual value is the value that the browser actually uses when it renders the page. An example from the spec is:</p>
<blockquote>
<p>the user agent may be forced to use only black and white shades instead of full color</p>
</blockquote>
<p>The details of this process are defined in the <a href="http://www.w3.org/TR/CSS2/cascade.html#value-stages">spec on value-stages</a>.</p>
<p>As CSS authors, we have the most control over specified values so let’s focus our attention on how those get evaluated:</p>
<blockquote>
<p>6.1.1 Specified values</p>
<p>User agents must first assign a specified value to each property based on the following mechanisms (in order of precedence):</p>
<p>If the cascade results in a value, use it. Otherwise, if the property is inherited and the element is not the root of the document tree, use the computed value of the parent element. Otherwise use the property’s initial value. The initial value of each property is indicated in the property’s definition.</p>
</blockquote>
<p>So, the cascade is still the first and foremost consideration, but now we start to look at cases where no direct style rule has been defined for a particular element. In such cases, inheritance and inital values will be considered. You’re probably asking yourself, “What is this <em>inheritance</em> thing, and what’s a property’s <em>initial value</em>? Let’s look at those now.</p>
</section>
<section id="take-a-deep-breath" class="level2">
<h2>Take a Deep Breath</h2>
<p>We’ve delved pretty deep into the details of the Cascade. Let’s try not to get too overwhelmed by these details and recap the most important bits:</p>
<ul>
<li>Rules from the Cascade are considered first</li>
<li>Then inherited rules</li>
<li>Then initial values</li>
</ul>
<p>Whew!</p>
</section>
<section id="specificity" class="level2">
<h2>Specificity</h2>
<p>I’ve shown you earlier that origin is considered before specificity, but I have a confession to make…page authors generally only need to worry about specificity since, as stated, the author stylesheet gets the most weight.</p>
<section id="calculating-specificity" class="level3">
<h3>Calculating Specificity</h3>
<p>In order to determine how two or more conflicting style rules will get resolved (providing they have the same <em>weight</em>), the browser uses a sort of “scoring system” called <a href="http://www.w3.org/TR/CSS2/cascade.html#specificity">specificity</a>. The main idea is that rules with a higher specificity will take precedence over those with a lower specificity.</p>
<p>Specificity is calculated as a four digit comma delimited number where each number can be labeled from left to right as: ‘a’, ‘b’, ‘c’, ‘d’.</p>
<ul>
<li>Add 1 to ‘a’ if there’s an inline ‘style’ attribute is used</li>
<li>Add 1 to ‘b’ for each ID in the selector</li>
<li>Add 1 to ‘c’ for each class, attribute and pseudo-classes in the selector</li>
<li>Add 1 to ‘d’ for each element names and pseudo-elements in the selector</li>
</ul>
<p>To gather the total specificity we simply concatenate those four numbers. Here are some examples straight from the <a href="http://www.w3.org/TR/CSS2/cascade.html#specificity">spec</a>:</p>
<pre class="sourceCode css"><code class="sourceCode css"> *             <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=0 d=0 -&gt; specificity = 0,0,0,0 */</span>
 li            <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=0 d=1 -&gt; specificity = 0,0,0,1 */</span>
 li<span class="dv">:first-line</span> <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=0 d=2 -&gt; specificity = 0,0,0,2 */</span>
 ul li         <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=0 d=2 -&gt; specificity = 0,0,0,2 */</span>
 ul ol+li      <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=0 d=3 -&gt; specificity = 0,0,0,3 */</span>
 h1 + *<span class="ch">[rel=up]</span><span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=1 d=1 -&gt; specificity = 0,0,1,1 */</span>
 ul ol li<span class="fl">.red</span>  <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=1 d=3 -&gt; specificity = 0,0,1,3 */</span>
 li<span class="fl">.red.level</span>  <span class="kw">{}</span>  <span class="co">/* a=0 b=0 c=2 d=1 -&gt; specificity = 0,0,2,1 */</span>
 <span class="fl">#x34y</span>         <span class="kw">{}</span>  <span class="co">/* a=0 b=1 c=0 d=0 -&gt; specificity = 0,1,0,0 */</span>
 style=<span class="st">&quot;&quot;</span>          <span class="co">/* a=1 b=0 c=0 d=0 -&gt; specificity = 1,0,0,0 */</span></code></pre>
<p>Let’s take a look at a few more examples from within a simple html page:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;head&gt;</span>
<span class="kw">&lt;style</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="kw">&gt;</span>
body <span class="kw">{</span> <span class="kw">color:</span> <span class="dt">blue</span><span class="kw">;</span> <span class="kw">}</span>
<span class="fl">#abc</span> <span class="kw">{</span> <span class="kw">color:</span> <span class="dt">red</span><span class="kw">;</span>  <span class="kw">}</span>
<span class="kw">&lt;/style&gt;</span>
<span class="kw">&lt;/head&gt;</span>
<span class="kw">&lt;body&gt;</span>
  <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;abc&quot;</span><span class="kw">&gt;</span>I have and ID so I will render red<span class="kw">&lt;/p&gt;</span>
  <span class="kw">&lt;h1</span><span class="ot"> style=</span><span class="st">&quot;color: green&quot;</span><span class="kw">&gt;</span>I have an inline style and render green<span class="kw">&lt;/h1&gt;</span>
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>In this example, we have two defined style rules for <code>body</code> and <code>#abc</code>. The body rule has a specificity of <code>0001</code> and the <code>#abc</code> has a specificity of <code>0100</code>. The ID clearly “wins”. The <code>h1</code> has an inline style and will thus calculate to <code>1000</code>.</p>
<p>Let’s look at one more fairly complex selector:</p>
<pre class="sourceCode css"><code class="sourceCode css"><span class="fl">#foo</span> &gt; <span class="fl">#bar</span> ul<span class="fl">.klass</span> li p<span class="dv">:first-line</span> <span class="kw">{}</span>
<span class="co">/* a=0 b=2 c=1 d=4 -&gt; specificity = 0,2,1,4 */</span></code></pre>
<ul>
<li>No inline <code>style</code> so a=0</li>
<li>Two IDs, <code>#foo</code> and <code>#bar</code> so b=2</li>
<li>One class <code>.klass</code> so c=1</li>
<li>Three elements <code>ul</code>, <code>li</code>, and <code>p</code>, as well as one pseudo-element <code>:first-line</code> so d=4</li>
</ul>
<p>Selector syntax is out of the scope for this book, but you can find the general rules for <a href="http://www.w3.org/TR/css3-selectors/#selectors">selectors here</a>.</p>
</section>
<section id="specificity-and-inheritance" class="level3">
<h3>Specificity and Inheritance</h3>
<p>In his tome on CSS, <a href="http://shop.oreilly.com/product/9780596527334.do">CSS: The Definitive Guide, 3rd Edition</a>, Eric Meyer points out that inherited values have absolutely no specificity at all–yes, that’s less than zero specificity–so an inherited rule will lose to a rule defined by the universal selector:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;style&gt;</span>
  * <span class="kw">{</span>
    <span class="kw">color:</span> <span class="dt">green</span><span class="kw">;</span>
  <span class="kw">}</span>
  <span class="fl">.outer</span> <span class="kw">{</span>
    <span class="kw">color:</span> <span class="dt">blue</span><span class="kw">;</span>
  <span class="kw">}</span>
<span class="kw">&lt;/style&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;outer&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;p&gt;</span>I will be green<span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>The takeaway is that inherited rules have no specificity regardless of how specific the rule is when applied to the original ancester element.</p>
</section>
<section id="specificity-and-performance" class="level3">
<h3>Specificity and Performance</h3>
<p>Worrying about selector performance is generally a futile effort, but, if you agree that <a href="http://smacss.com/book/applicability">deep selectors</a> are detrimental anyway, you’ll be happy to learn that <a href="https://developers.google.com/speed/docs/best-practices/rendering#UseEfficientCSSSelectors">browsers parse CSS from right to left</a> where the rightmost selector, called the <em>key</em>, is first considered before those to the left of it. You’ll likely benefit much more from removing unused rules, than from trying to hand optimize the depth of selectors, but, you should adopt a coding style such as <a href="https://smacss.com/">smacss</a> or <a href="https://github.com/stubbornella/oocss/wiki#two-main-principles-of-oocss">oocss</a> that prevents this in the first place.</p>
</section>
</section>
<section id="media" class="level2">
<h2>Media</h2>
<p>As mentioned earlier, the first step in evaluating the cascade, is to gather all relevent rules that apply for the current medium. This can be a factor when you’re web site or application targets more than one medium. We’ll take on print as that’s a common use case.</p>
<section id="print-media" class="level3">
<h3>Print Media</h3>
<p>When a user elects to print one of your web pages, the current medium will be <strong>print</strong>. When this happens, it’s preferable to only have to deal with one print stylesheet. However, if you’ve set your most general stylesheets to apply to <strong>all</strong> media (e.g. <code>medial=&quot;all&quot;</code>) your print stylesheet will have to “fight” against the more general stylesheets to win the specificity battle. You might instead want to target the media type of <strong>screen</strong> for your general stylesheets to avoid this. Generally, if you see a ton of <code>!important</code> values in the print stylesheet, it’s a code smell that indicates the misuse of <code>media=&quot;all&quot;</code>.</p>
</section>
<section id="debugging-print-styles" class="level3">
<h3>Debugging Print Styles</h3>
<p>Eric Meyer provides a wonderful trick for debugging stylesheets in his book <a href="http://meyerweb.com/eric/books/smashing/">Smashing CSS: Professional Techniques for Modern Layout</a>. Essentially, you turn off the general stylesheets, by purposely setting the media type to something other than <strong>all</strong> or <strong>screen</strong>. Then, you set your print stylesheet to <strong>screen</strong>. Once that’s done, you should be able to load your site in a normal browser–which is the <strong>screen</strong> medium–and have access to all your favorite developer tools as well as frequent page reloading. Here’s an example of setting up such an approach:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> href=</span><span class="st">&quot;styles.css&quot;</span><span class="ot"> media=</span><span class="st">&quot;tv&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/css&quot;</span><span class="ot"> href=</span><span class="st">&quot;print.css&quot;</span><span class="ot"> media=</span><span class="st">&quot;screen&quot;</span><span class="kw">&gt;</span></code></pre>
<p>Once you’ve got your print styles looking the way you want, you’d simply switch <code>styles.css</code> to point to <code>media=&quot;screen&quot;</code>, and <code>print.css</code> to point to <code>media=&quot;print&quot;</code>. Neat trick, huh!</p>
</section>
</section>
<section id="resources" class="level2">
<h2>Resources</h2>
<p><a href="http://www.w3.org/TR/CSS2/cascade.html">CSS 2.1 Cascade Spec</a></p>
<p><a href="http://www.w3.org/TR/css3-cascade/#changes-2013">CSS3 Cascade Spec</a></p>
<p><a href="http://shop.oreilly.com/product/9780596802455.do">CSS: The Missing Manual</a></p>
<p><a href="http://shop.oreilly.com/product/9780596527334.do">CSS: The Definitive Guide, 3rd Edition</a></p>
<p><a href="http://meyerweb.com/eric/books/smashing/">Smashing CSS: Professional Techniques for Modern Layout</a></p>
<p>If you’d like a visual presentation of how the cascade rules are applied you may want to check out Russ Weakley’s excellent <a href="http://www.slideshare.net/maxdesign/css-cascade-1658158">CSS Cascade Slideshare</a> chock full of extremely useful examples.</p>
</section>
</section>
<section id="visual-formatting" class="level1">
<h1>Visual Formatting</h1>
<p>This chapter will discuss CSS’s main weapon of choice, boxes. The CSS <em>box model</em> defines how rectangular boxes are to be laid on in your document. As always, I encourage you to cross-reference the details in the <a href="http://www.w3.org/TR/CSS2/box.html">box-model specification</a>, and the <a href="http://www.w3.org/TR/CSS2/visuren.html">visual formatting model specification</a>.</p>
<section id="box-model-review" class="level2">
<h2>Box Model Review</h2>
<p>Let’s review of the CSS box model:</p>
<p><img src="examples/visual/box-model.png" title="The box model consists of margin, border, padding, and content" alt="Box Model" /><br /> Taking the example diagram from the inside out we have:</p>
<ul>
<li>Content: The content area contains your text, images, etc.</li>
<li>Padding: The content can optionally be surrounded by padding</li>
<li>Border: The box optionally can have a visible border</li>
<li>Margin: A transparent area that surrounds the box</li>
</ul>
<section id="edges" class="level3">
<h3>Edges</h3>
<p>The edges of the above described sections of the box can be further broken down in to top, right, bottom, and left. We can thus describe the top outermost area of content just before the padding starts as the <em>top content edge</em>. Similarly, we might describe the bottom-most padding area just before the border as the <em>bottom padding edge</em>.</p>
<p>Edges can be shared as per the specification, starting with the padding edge:</p>
<blockquote>
<p>If the padding has 0 width, the padding edge is the same as the content edge</p>
</blockquote>
<p>Same for borders:</p>
<blockquote>
<p>If the border has 0 width, the border edge is the same as the padding edge</p>
</blockquote>
<p>And for margins:</p>
<blockquote>
<p>If the margin has 0 width, the margin edge is the same as the border edge</p>
</blockquote>
</section>
<section id="backgrounds" class="level3">
<h3>Backgrounds</h3>
<p>The content and padding background are specified by the containing block’s <em>background</em> property (and, additionally, any of its children’s background properties). Margins are transparent.</p>
</section>
<section id="widths" class="level3">
<h3>Widths</h3>
<p>We’ll delve deeper in to how the width of a box is calculated, but, for now, let’s take the simplest case that width–in the most simplest cases–is determined by adding up the components of the box model:</p>
<p><em>Left margin + left border + left padding + content + right padding + right border + right margin = width</em></p>
</section>
</section>
<section id="margins" class="level2">
<h2>Margins</h2>
<p>Margins can be set for all four sides with the caveat that vertical margins will not effect non-replaced inline elements (such as images).</p>
<p>Margins can be set with either of: <code>auto</code> (which we’ll discuss in a later section), <code>length</code>, or <code>percentage</code>.</p>
<p>Margins set with length are fairly straight forward as you specify a fixed value such as <code>margin: 5px</code>;</p>
<p>Margins set with percentage are bit trickier starting with this fact from the <a href="http://www.w3.org/TR/CSS2/box.html#margin-properties">spec</a>:</p>
<blockquote>
<p>The percentage is calculated with respect to the width of the generated box’s containing block. <strong>Note that this is true for ‘margin-top’ and ‘margin-bottom’ as well.</strong>…</p>
</blockquote>
<p>The takeaway is to be careful if you use <code>margin-top</code> or <code>margin-bottom</code> with a percentage since that percentage is relative to the containing block’s width (not it’s height).</p>
</section>
<section id="horizontal-formatting" class="level2">
<h2>Horizontal Formatting</h2>
<p>When thinking about horizontal formatting an obvious question is “How is an element’s width calculated?”. Let’s start there.</p>
<p>http://codepen.io/roblevin/pen/gmsIx</p>
<section id="width" class="level3">
<h3>Width</h3>
<p>A particular block-level boxes width must add up to its containing block’s “content edge”. Therefore, if a containing block as a width of 80 pixels and the padding on the sides adds up to 20 pixels (provided there’s no margin or borders), its width is 100 pixels. Thus a child block-level element’s width will be 100 pixels per the <a href="http://www.w3.org/TR/CSS2/visudet.html#blockwidth">spec</a>:</p>
<blockquote>
<p>‘margin-left’ + ‘border-left-width’ + ‘padding-left’ + ‘width’ + ‘padding-right’ + ‘border-right-width’ + ‘margin-right’ = <em>width of containing block</em></p>
</blockquote>
<p>If the spec isn’t clear enough we can refer to the following from Eric Meyer:</p>
<blockquote>
<p>For an element in the normal, Western-style flow of text, the containing block is formed by the <em>content edge</em> of the nearest block-level, table-cell, or inline-block anscestor box.</p>
</blockquote>
<p>TODO PROVIDE IMAGE HERE</p>
<section id="auto" class="level4">
<h4>Auto</h4>
<p>Generally, a horizontal property having a value of <code>auto</code> will result in that property being calculated to be whatever is required to comply with the rule stated above (that block-level boxes add up to their containing block’s width).</p>
<p>For example, let’s say we have code specified as follows:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div&gt;&lt;p&gt;</span>This is a paragraph<span class="kw">&lt;/p&gt;&lt;/div&gt;</span></code></pre>
<pre class="sourceCode css"><code class="sourceCode css">div <span class="kw">{</span>
  <span class="kw">width:</span> <span class="dt">800px</span><span class="kw">;</span>
<span class="kw">}</span>
p <span class="kw">{</span>
  <span class="kw">margin-left:</span> <span class="dt">auto</span><span class="kw">;</span>
  <span class="kw">margin-right:</span> <span class="dt">200px</span><span class="kw">;</span>
  <span class="kw">width:</span> <span class="dt">200px</span><span class="kw">;</span>
<span class="kw">}</span></code></pre>
<p>Note that our paragraph is defined with a left margin of auto, and a width &amp; right margin to 200px, while the containing block is defined at 800 pixels wide. Since the content edge of this containing block is 800 pixels wide, the margin-left will need to be 400 pixels to comply with the width rule we’ve stated above.</p>
<p>TODO PROVIDE IMAGE HERE</p>
</section>
</section>
<section id="overconstrained-values" class="level3">
<h3>Overconstrained Values</h3>
<p>If a child-block’s total specified values do not “add up” to the expected containing block width, then the difference will be made up on the right margin (provided the directionality is left-to-right; if not, the rule is flipped and the margin-left will make up the difference).</p>
<p>TODO PROVIDE IMAGE HERE ML 200px + Content 200px + MR 200px (MR will == 400px)</p>
</section>
<section id="horizontal-centering" class="level3">
<h3>Horizontal Centering</h3>
<p>You might already know this, but if you set the block-level child element’s margin to the same values such as: <code>margin-left: 200px; margin-right 200px</code>, and then set the width: <code>width: auto;</code>, the element will be horizontally centered.</p>
<p><em>You can also center by setting the margin: <code>margin: 0 auto</code> where the natural content width will be used and then the left and right margins will be calculated equally to center the element.</em></p>
</section>
</section>
<section id="vertical-formatting" class="level2">
<h2>Vertical Formatting</h2>
<p>TBD</p>
<p>http://codepen.io/roblevin/pen/szavA?editors=110</p>
<section id="margin-collapsing" class="level3">
<h3>Margin Collapsing</h3>
<p>http://www.w3.org/TR/CSS2/box.html#collapsing-margins</p>
<p>http://codepen.io/roblevin/pen/Dnxbq?editors=110</p>
</section>
</section>
</section>
<script type="text/javascript">
/*
TODO
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'TODO-PUT-GA-ACOUNT-HERE']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
*/
</script>
</body>
</html>
